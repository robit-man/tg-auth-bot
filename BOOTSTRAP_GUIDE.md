# Bootstrap & Auto-Configuration Guide

## Overview

The bot includes several auto-configuration features that ensure required files and dependencies are properly set up.

## Auto-Generated Files

### 1. requirements-tools.txt

**What**: Python package dependencies for tools (search_internet, etc.)

**How it works**:
- The dependency list is baked into [bot_server.py](bot_server.py#L14-L29) as `TOOL_DEPENDENCIES`
- On every startup, `ensure_tool_requirements_file()` writes/updates `requirements-tools.txt`
- This ensures the requirements file is always in sync with the code
- If the file is deleted, it will be automatically recreated on next run

**Location in code**: [bot_server.py:179-191](bot_server.py#L179-L191)

```python
# The dependency list
TOOL_DEPENDENCIES = """# Tool dependencies for search_internet and other web tools
# Auto-generated by bot_server.py
...
"""

# Auto-generation function
def ensure_tool_requirements_file():
    """Auto-generate requirements-tools.txt if tools are unavailable"""
    req_file = Path(__file__).parent / "requirements-tools.txt"
    req_file.write_text(TOOL_DEPENDENCIES)
```

**Install dependencies**:
```bash
pip install -r requirements-tools.txt
# or
./install_tool_deps.sh
```

## Dependency Detection

The bot gracefully handles missing dependencies:

### Tool Dependencies

When tools are unavailable (e.g., `beautifulsoup4`, `selenium` not installed):

1. **On import**: Bot detects missing dependencies
   ```
   [bootstrap] Tools unavailable - missing dependencies
   [bootstrap] Install with: pip install -r requirements-tools.txt
   [bootstrap] Or run: ./install_tool_deps.sh
   ```

2. **On tool use**: User-friendly error message
   ```
   Tools not available - check dependencies
   ```

3. **Bot continues**: Non-tool features work normally

### Visualizer (Optional)

If `memory_visualizer.py` import fails:
- Falls back to simple console logging
- Bot continues to function

### Sleep Cycle (Optional)

If `sleep_cycle.py` import fails:
- Memory autonomous operations are disabled
- Bot continues to function

## Bootstrap Flow

When `bot_server.py` is imported/executed:

```
1. Define TOOL_DEPENDENCIES constant (lines 14-29)
2. Import standard libraries
3. Call ensure_tool_requirements_file() (line 191)
   └─> Writes requirements-tools.txt
4. Try importing memory_visualizer (optional)
5. Try importing ai_tool_bridge
   └─> If fails, show install instructions
6. Try importing tool_integration
7. Continue with rest of imports
8. Run main() if executed directly
```

## Modifying Tool Dependencies

To add/remove tool dependencies:

1. Edit the `TOOL_DEPENDENCIES` string in [bot_server.py](bot_server.py#L14-L29)
2. Restart the bot (or just import it)
3. `requirements-tools.txt` is automatically updated
4. Run `pip install -r requirements-tools.txt` to install new deps

**Example**:
```python
TOOL_DEPENDENCIES = """# Tool dependencies
beautifulsoup4>=4.11.0
lxml>=4.9.0
requests>=2.28.0
selenium>=4.10.0
webdriver-manager>=3.8.0
ollama>=0.1.0
my-new-package>=1.0.0  # <-- Add new dependency here
"""
```

## Design Principles

1. **Self-Healing**: Missing files are auto-generated on startup
2. **Graceful Degradation**: Missing dependencies don't crash the bot
3. **Single Source of Truth**: Dependencies defined once in bot_server.py
4. **User-Friendly**: Clear error messages with installation instructions
5. **Zero Manual Setup**: No manual file creation required

## Files Overview

| File | Auto-Generated? | Purpose |
|------|----------------|---------|
| `requirements-tools.txt` | ✓ Yes | Tool dependencies (pip install) |
| `install_tool_deps.sh` | Manual | Helper script to install deps |
| `TOOL_SETUP.md` | Manual | User documentation |
| `BOOTSTRAP_GUIDE.md` | Manual | This file (dev documentation) |

## Troubleshooting

**Q: requirements-tools.txt keeps getting overwritten**
- This is intentional - it's auto-generated from bot_server.py
- To modify dependencies, edit `TOOL_DEPENDENCIES` in bot_server.py

**Q: How do I prevent auto-generation?**
- You don't. It's a design feature to ensure consistency
- Make the file read-only if you must: `chmod 444 requirements-tools.txt`

**Q: Tools still unavailable after installing requirements**
- Verify installation: `python3 -c "from tools import Tools; print('OK')"`
- Check for import errors: `python3 -c "import bot_server"`
- See [TOOL_SETUP.md](TOOL_SETUP.md) for detailed troubleshooting

## Implementation Details

The auto-generation is triggered by a module-level function call:

```python
# Call on import to ensure requirements file exists
ensure_tool_requirements_file()
```

This means the file is generated whenever bot_server.py is imported, not just when `main()` runs. This ensures the file exists even during import-time checks.
